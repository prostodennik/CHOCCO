const openItem=e=>{const t=e.closest(".teams__item"),a=t.find(".teams__descripton"),o=a.find(".teams__descriotion-block");e=o.height();const n=t.find(".teams__triangle");n.addClass("teams__triangle_up"),t.addClass("active"),a.height(e)},closeEveryItem=e=>{const t=e.find(".teams__descripton"),a=e.find(".teams__item"),o=e.find(".teams__triangle");o.removeClass("teams__triangle_up"),a.removeClass("active"),t.height(0)};$(".teams__item").click(e=>{const t=$(e.currentTarget);e=t.closest(".teams");const a=t.closest(".teams__item");a.hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});let myMap;const init=()=>{myMap=new ymaps.Map("map",{center:[59.93916998692174,30.309015096732622],zoom:11,controls:[],garg:!1});let t=[[59.94554327989287,30.38935262114668],[59.91142323563909,30.50024587065841],[59.88693161784606,30.319658102103713],[59.97033574821672,30.315194906302924]],a=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});for(let e=0;e<t.length;e++)a.add(new ymaps.Placemark(t[e]));myMap.geoObjects.add(a),myMap.behaviors.disable("scrollZoom")};ymaps.ready(init);const mesureWidth=e=>{let t=0;var a=$(window).width();const o=e.closest(".slide-menu"),n=o.find(".slide-menu__title");var l=n.width()*n.length;const r=e.find(".slide-menu__container");var s=parseInt(r.css("padding-left")),e=parseInt(r.css("padding-right"));return t=480<a&&a<769?a-l:a<480?a-n.width():500,{container:t,textContainer:t-e-s}},closeEveryItemCont=e=>{const t=e.find(".slide-menu__item"),a=e.find(".slide-menu__content");t.removeClass("active-acco"),a.width(0)},openItemAcco=e=>{const t=e.find(".slide-menu__content");var a=mesureWidth(e);const o=e.find(".slide-menu__container");e.addClass("active-acco"),t.width(a.container),o.width(a.textContainer)};$(".slide-menu__title").on("click",e=>{e.preventDefault();const t=$(e.currentTarget),a=t.closest(".slide-menu__item");var o=a.hasClass("active-acco"),e=t.closest(".slide-menu");o?closeEveryItemCont(e):(closeEveryItemCont(e),openItemAcco(a))}),$(".slide-menu__close").on("click",e=>{e.preventDefault(),closeEveryItemCont($(".slide-menu"))});const hamburgerBtn=document.querySelector(".hamburger"),modalMenu=document.querySelector(".fullscreen-menu"),body=document.body,hamburgerBtnClose=document.getElementById("close");hamburgerBtn.addEventListener("click",function(){modalMenu.style.display="flex",body.style.overflow="hidden"}),hamburgerBtnClose.addEventListener("click",function(){modalMenu.style.display="none",body.style.overflow=""});const validateFields=(e,t)=>{return t.forEach(e=>{e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};function openModal(e){$(".modal").addClass("modal--active"),$("body").addClass("blocked")}$("#form").on("submit",function(e){e.preventDefault();const t=$(e.currentTarget),a=t.find("[name='name']"),o=t.find("[name='phone']"),n=t.find("[name='comment']"),l=t.find("[name='to']"),r=$("#modal"),s=r.find(".modal__content");if(r.removeClass("error-modal"),validateFields(t,[a,o,n,l])){const i=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:a.val(),phone:o.val(),comment:n.val(),to:l.val()}});i.done(e=>{s.text(e.message)}),i.fail(e=>{e=e.responseJSON.message;s.text(e),r.addClass("error-modal")}),i.always(()=>{openModal()})}}),$(".js-modal--close").click(function(e){e.preventDefault(),$(".modal").removeClass("modal--active"),$("body").removeClass("blocked")});const section=$(".section"),display=$(".maincontent"),sideMenu=$(".fixed-menu__link"),fixedMenu=$(".fixed-menu"),menuItems=fixedMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile();let inScroll=!1;section.first().addClass("active-scroll");const countSectionPosition=e=>{e*=-100;return isNaN(e)?(console.error("переданно не верное значение в countSectionPosition"),0):e},changeMenuThemeForSection=e=>{const t=section.eq(e);e="fixed-menu_black";"black"==t.attr("data-sidemenu-theme")?sideMenu.addClass(e):sideMenu.removeClass(e)},resetActiveClassForItem=(e,t,a)=>{e.eq(t).addClass(a).siblings().removeClass(a)},perfomTransition=e=>{var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:`translateY(${t}%)`}),resetActiveClassForItem(section,e,"active-scroll"),setTimeout(()=>{inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item_active")},1300))},viewportScroller=()=>{const e=section.filter(".active-scroll"),t=e.next(),a=e.prev();return{next(){t.length&&perfomTransition(t.index())},prev(){a.length&&perfomTransition(a.index())}}};$(window).on("wheel",e=>{e=e.originalEvent.deltaY;const t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t;const a=viewportScroller();if(!t)switch(e.keyCode){case 38:a.prev();break;case 40:a.next()}}),$(".wrapper").on("touchmove",e=>e.preventDefault()),$("[data-scroll-to]").click(e=>{e.preventDefault(),modalMenu.style.display="none",body.style.overflow="";const t=$(e.currentTarget);e=t.attr("data-scroll-to");const a=$(`[data-section-id=${e}]`);perfomTransition(a.index())}),isMobile&&$("body").swipe({swipe:function(e,t){const a=viewportScroller();let o="";"up"==t&&(o="next",a[o]()),"down"==t&&(o="prev",a[o]())}});const playerContainer=document.querySelector(".video__player"),playerStart=document.querySelector(".player__start"),playerWrapper=document.querySelector(".player__wrapper"),video=document.querySelector(".video"),playerPlay=document.querySelector(".player__play"),playerPlayback=document.querySelector(".player__playback-line"),playerPlaybackBtn=document.querySelector(".player__playback-button"),playerPlaybackIcon=document.querySelector(".player__sound-icon"),playerPlaybackIconMute=document.querySelector(".player__sound-icon-mute"),soundLine=document.querySelector(".player__sound-line"),soundBtn=document.querySelector(".player__sound-button");let startVolume=0,currentVolume;const hadleStart=()=>{video.paused?video.play():video.pause()};playerPlay.addEventListener("click",e=>{e.stopPropagation(),hadleStart()}),playerStart.addEventListener("click",hadleStart),playerWrapper.addEventListener("click",hadleStart),video.onplay=()=>{playerStart.classList.add("paused"),playerStart.classList.remove("player__start"),playerPlay.classList.add("player__play-none")},video.onpause=()=>{playerStart.classList.remove("paused"),playerStart.classList.add("player__start"),playerPlay.classList.remove("player__play-none")};const changeVolume=e=>{const t=e.currentTarget;var a=t.getBoundingClientRect().left,o=parseInt(getComputedStyle(t).width),o=(e.pageX-a)/o*100;video.volume=o/100,soundBtn.style.left=`${o}%`},toogleSound=()=>{playerPlaybackIcon.classList.toggle("sound-none"),playerPlaybackIconMute.classList.toggle("sound-mute"),0==video.volume?(video.volume=currentVolume,soundBtn.style.left=`${100*currentVolume}%`):(currentVolume=video.volume,video.volume=startVolume,soundBtn.style.left=`${startVolume}%`)};soundLine.addEventListener("click",changeVolume),playerPlaybackIcon.addEventListener("click",toogleSound),playerPlaybackIconMute.addEventListener("click",toogleSound);const handleDuration=e=>{var t=parseInt(getComputedStyle(playerPlayback).width),a=parseInt(getComputedStyle(playerPlaybackBtn).width),t=(e.offsetX+a/2)*video.duration/t;video.currentTime=t},updateTime=()=>{var e=video.currentTime/video.duration;playerPlaybackBtn.style.left=`${100*e}%`,video.ended&&(video.currentTime=0)};playerPlayback.addEventListener("click",handleDuration),video.addEventListener("timeupdate",updateTime);const slider=$(".shop").bxSlider({pager:!1,controls:!1,touchEnabled:$(window).width()<768});$(".arrow__left").click(e=>{slider.goToPrevSlide()}),$(".arrow__right").click(e=>{slider.goToNextSlide()});const findBlockByAlias=a=>$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")==a);$(".reviews__switcher-link").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-open");const a=findBlockByAlias(e),o=t.closest(".interactive-avatar");a.addClass("active").siblings().removeClass("active"),o.addClass("interactive-avatar_active").siblings().removeClass("interactive-avatar_active")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGlvbi5qcyIsIm1hcC5qcyIsIm1lbnUtYWNjb3JkLmpzIiwibW9kYWwuanMiLCJtb2RhbDEuanMiLCJvcHMuanMiLCJwbGF5ZXIuanMiLCJzbGlkZXIuanMiLCJ0YWJzLmpzIl0sIm5hbWVzIjpbIm9wZW5JdGVtIiwiY29udGFpbmVyIiwiaXRlbSIsImNsb3Nlc3QiLCJjb250ZW50QmxvY2siLCJmaW5kIiwidGV4dEJsb2NrIiwicmVxSGVpZ2h0IiwiaGVpZ2h0IiwidHJpYW5nbGUiLCJhZGRDbGFzcyIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbXMiLCJpdGVtQ29udGFpbmVyIiwidHJpYW5nbGVVcCIsInJlbW92ZUNsYXNzIiwiJCIsImNsaWNrIiwiJHRoaXMiLCJlIiwiY3VycmVudFRhcmdldCIsImVsZW1Db250YWluZXIiLCJoYXNDbGFzcyIsIm15TWFwIiwiaW5pdCIsInltYXBzIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsImNvbnRyb2xzIiwiZ2FyZyIsImNvb3JkcyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJpIiwibGVuZ3RoIiwiYWRkIiwiUGxhY2VtYXJrIiwiZ2VvT2JqZWN0cyIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJyZWFkeSIsIm1lc3VyZVdpZHRoIiwicmVxSXRlbVdpZHRoIiwic2NyZWVuV2lkdGgiLCJ3aW5kb3ciLCJ3aWR0aCIsInRpdGxlc0Jsb2NrcyIsInRpdGxlc1dpZHRoIiwidGV4dENvbnRhaW5lciIsInBhZGRpbmdMZWZ0IiwicGFyc2VJbnQiLCJjc3MiLCJwYWRkaW5nUmlnaHQiLCJjbG9zZUV2ZXJ5SXRlbUNvbnQiLCJjb250ZW50Iiwib3Blbkl0ZW1BY2NvIiwiaGlkZGVuQ29udGVudCIsInJlcVdpZHRoIiwib24iLCJwcmV2ZW50RGVmYXVsdCIsIml0ZW1PcGVuZWRBY2NvIiwiaGFtYnVyZ2VyQnRuIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibW9kYWxNZW51IiwiYm9keSIsImhhbWJ1cmdlckJ0bkNsb3NlIiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwic3R5bGUiLCJkaXNwbGF5Iiwib3ZlcmZsb3ciLCJ2YWxpZGF0ZUZpZWxkcyIsImZvcm0iLCJmaWxkc0FycmF5IiwiZm9yRWFjaCIsImZpZWxkIiwidmFsIiwidHJpbSIsIm9wZW5Nb2RhbCIsImV2ZW50IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwic2VjdGlvbiIsInNpZGVNZW51IiwiZml4ZWRNZW51IiwibWVudUl0ZW1zIiwibW9iaWxlRGV0ZWN0IiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaXNNb2JpbGUiLCJtb2JpbGUiLCJpblNjcm9sbCIsImZpcnN0IiwiY291bnRTZWN0aW9uUG9zaXRpb24iLCJzZWN0aW9uRXEiLCJwb3NpdGlvbiIsImlzTmFOIiwiY29uc29sZSIsImVycm9yIiwiY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiIsImN1cnJlbnRTZWN0aW9uIiwiZXEiLCJhY3RpdmVDbGFzcyIsImF0dHIiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1FcSIsInNpYmxpbmdzIiwicGVyZm9tVHJhbnNpdGlvbiIsInRyYW5zZm9ybSIsInNldFRpbWVvdXQiLCJ0cmFuc2l0aW9uT3ZlciIsInZpZXdwb3J0U2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwiZmlsdGVyIiwibmV4dFNlY3Rpb24iLCJuZXh0IiwicHJldlNlY3Rpb24iLCJwcmV2IiwiaW5kZXgiLCJkZWx0YVkiLCJvcmlnaW5hbEV2ZW50Iiwic2Nyb2xsZXIiLCJ0YWdOYW1lIiwidGFyZ2V0IiwidG9Mb3dlckNhc2UiLCJ1c2VyVHlwaW5nSW5JbnB1dCIsImtleUNvZGUiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJkaXJlY3Rpb24iLCJzY3JvbGxEaXJlY3Rpb24iLCJwbGF5ZXJDb250YWluZXIiLCJwbGF5ZXJTdGFydCIsInBsYXllcldyYXBwZXIiLCJ2aWRlbyIsInBsYXllclBsYXkiLCJwbGF5ZXJQbGF5YmFjayIsInBsYXllclBsYXliYWNrQnRuIiwicGxheWVyUGxheWJhY2tJY29uIiwicGxheWVyUGxheWJhY2tJY29uTXV0ZSIsInNvdW5kTGluZSIsInNvdW5kQnRuIiwic3RhcnRWb2x1bWUiLCJjdXJyZW50Vm9sdW1lIiwiaGFkbGVTdGFydCIsInBhdXNlZCIsInBsYXkiLCJwYXVzZSIsInN0b3BQcm9wYWdhdGlvbiIsIm9ucGxheSIsImNsYXNzTGlzdCIsInJlbW92ZSIsIm9ucGF1c2UiLCJjaGFuZ2VWb2x1bWUiLCJsZWZ0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwic291bmRMaW5lV2lkdGgiLCJnZXRDb21wdXRlZFN0eWxlIiwicGVyY2VudFZhbHVlIiwicGFnZVgiLCJ2b2x1bWUiLCJ0b29nbGVTb3VuZCIsInRvZ2dsZSIsImhhbmRsZUR1cmF0aW9uIiwiYmFyU2l6ZSIsImNpcmNsZVdpZHRoIiwibmV3VGltZSIsIm9mZnNldFgiLCJkdXJhdGlvbiIsImN1cnJlbnRUaW1lIiwidXBkYXRlVGltZSIsImJhciIsImVuZGVkIiwic2xpZGVyIiwiYnhTbGlkZXIiLCJwYWdlciIsInRvdWNoRW5hYmxlZCIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwiZmluZEJsb2NrQnlBbGlhcyIsImFsaWFzIiwibmR4IiwiaXRlbVRvU2hvdyIsImN1ckl0ZW0iXSwibWFwcGluZ3MiOiJBQUFBLE1BQUFBLFNBQUEsSUFDQSxNQUFBQyxFQUFBQyxFQUFBQyxRQUFBLGdCQUNBQyxFQUFBSCxFQUFBSSxLQUFBLHNCQUNBQyxFQUFBRixFQUFBQyxLQUFBLDZC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QUNBLE1BQUErRSxFQUFBSCxpQkFBQXhELEdBQ0E0RCxFQUFBM0wsRUFBQWYsUUFBQSx1QkFHQXlNLEVBQUFsTSxTQUFBLFVBQUFzSCxXQUFBakgsWUFBQSxVQUNBOEwsRUFBQW5NLFNBQUEsNkJBQUFzSCxXQUFBakgsWUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgb3Blbkl0ZW0gPSAoaXRlbSkgPT4ge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi50ZWFtc19faXRlbVwiKTtcbiAgICBjb25zdCBjb250ZW50QmxvY2sgPSBjb250YWluZXIuZmluZChcIi50ZWFtc19fZGVzY3JpcHRvblwiKTtcbiAgICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtc19fZGVzY3Jpb3Rpb24tYmxvY2tcIik7XG4gICAgY29uc3QgcmVxSGVpZ2h0ID0gdGV4dEJsb2NrLmhlaWdodCgpO1xuICAgIGNvbnN0IHRyaWFuZ2xlID0gY29udGFpbmVyLmZpbmQoXCIudGVhbXNfX3RyaWFuZ2xlXCIpO1xuXG4gICAgdHJpYW5nbGUuYWRkQ2xhc3MoXCJ0ZWFtc19fdHJpYW5nbGVfdXBcIik7XG4gICAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgIGNvbnRlbnRCbG9jay5oZWlnaHQocmVxSGVpZ2h0KTtcbn07XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gKGNvbnRhaW5lcikgPT4ge1xuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIudGVhbXNfX2Rlc2NyaXB0b25cIik7XG4gICAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1zX19pdGVtXCIpO1xuICAgIGNvbnN0IHRyaWFuZ2xlVXAgPSBjb250YWluZXIuZmluZChcIi50ZWFtc19fdHJpYW5nbGVcIik7XG5cbiAgICB0cmlhbmdsZVVwLnJlbW92ZUNsYXNzKFwidGVhbXNfX3RyaWFuZ2xlX3VwXCIpO1xuICAgIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgaXRlbXMuaGVpZ2h0KDApO1xufTtcblxuJChcIi50ZWFtc19faXRlbVwiKS5jbGljaygoZSkgPT4ge1xuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbXNcIik7XG4gICAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbXNfX2l0ZW1cIik7XG5cbiAgICBpZiAoZWxlbUNvbnRhaW5lci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkge1xuICAgICAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XG4gICAgICAgIG9wZW5JdGVtKCR0aGlzKTtcbiAgICB9XG59KTsgICAiLCJsZXQgbXlNYXA7XG5jb25zdCBpbml0ID0gKCkgPT4ge1xuIG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLCB7XG4gICBjZW50ZXI6IFs1OS45MzkxNjk5ODY5MjE3NCwgMzAuMzA5MDE1MDk2NzMyNjIyXSxcbiAgIHpvb206IDExLFxuICAgY29udHJvbHM6IFtdLFxuICAgZ2FyZzogZmFsc2UsXG4gfSk7XG4gXG4gbGV0IGNvb3JkcyA9IFtcbiAgICAgWzU5Ljk0NTU0MzI3OTg5Mjg3LCAzMC4zODkzNTI2MjExNDY2OF0sXG4gICAgIFs1OS45MTE0MjMyMzU2MzkwOSwgMzAuNTAwMjQ1ODcwNjU4NDFdLFxuICAgICBbNTkuODg2OTMxNjE3ODQ2MDYsIDMwLjMxOTY1ODEwMjEwMzcxM10sXG4gICAgIFs1OS45NzAzMzU3NDgyMTY3MiwgMzAuMzE1MTk0OTA2MzAyOTI0XSxcbiAgIF0sXG4gICBteUNvbGxlY3Rpb24gPSBuZXcgeW1hcHMuR2VvT2JqZWN0Q29sbGVjdGlvbih7fSwge1xuICAgICBkcmFnZ2FibGU6IGZhbHNlLFxuICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXG4gICAgIGljb25JbWFnZUhyZWY6ICcuL2ltZy9tYXJrZXIuc3ZnJyxcbiAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXG4gICAgIGljb25JbWFnZU9mZnNldDogWy0zNSwgLTUyXVxuICAgfSk7XG4gXG4gZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgIG15Q29sbGVjdGlvbi5hZGQobmV3IHltYXBzLlBsYWNlbWFyayhjb29yZHNbaV0pKTtcbiB9XG4gXG4gbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcbiBcbiBteU1hcC5iZWhhdmlvcnMuZGlzYWJsZSgnc2Nyb2xsWm9vbScpO1xufTtcbiBcbnltYXBzLnJlYWR5KGluaXQpOyIsImNvbnN0IG1lc3VyZVdpZHRoID0gaXRlbSA9PiB7XG4gICAgbGV0IHJlcUl0ZW1XaWR0aCA9IDA7XG5cbiAgICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5zbGlkZS1tZW51XCIpO1xuICAgIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlLW1lbnVfX3RpdGxlXCIpO1xuICAgIGNvbnN0IHRpdGxlc1dpZHRoID0gdGl0bGVzQmxvY2tzLndpZHRoKCkgKiB0aXRsZXNCbG9ja3MubGVuZ3RoO1xuXG4gICAgY29uc3QgdGV4dENvbnRhaW5lciA9IGl0ZW0uZmluZChcIi5zbGlkZS1tZW51X19jb250YWluZXJcIik7XG4gICAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XG4gICAgY29uc3QgcGFkZGluZ1JpZ2h0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLXJpZ2h0XCIpKTtcblxuICAgIGNvbnN0IGlzVGFibGV0ID0gKHNjcmVlbldpZHRoID4gNDgwICYmIHNjcmVlbldpZHRoIDwgNzY5KTtcbiAgICBjb25zdCBpc01vYmlsZSA9IHNjcmVlbldpZHRoIDwgNDgwO1xuICAgIFxuICAgIGlmIChpc1RhYmxldCkge1xuICAgICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc1dpZHRoO1xuICAgIH0gZWxzZSBpZiAoaXNNb2JpbGUpIHtcbiAgICAgICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNCbG9ja3Mud2lkdGgoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXFJdGVtV2lkdGggPSAgNTAwO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBjb250YWluZXI6IHJlcUl0ZW1XaWR0aCxcbiAgICAgICAgdGV4dENvbnRhaW5lcjogcmVxSXRlbVdpZHRoIC0gcGFkZGluZ1JpZ2h0IC0gcGFkZGluZ0xlZnRcbiAgICB9XG59O1xuXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbUNvbnQgPSBjb250YWluZXIgPT4ge1xuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuc2xpZGUtbWVudV9faXRlbVwiKTtcbiAgICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIuc2xpZGUtbWVudV9fY29udGVudFwiKTtcblxuICAgIGl0ZW1zLnJlbW92ZUNsYXNzKFwiYWN0aXZlLWFjY29cIik7XG4gICAgY29udGVudC53aWR0aCgwKTtcbn1cblxuY29uc3Qgb3Blbkl0ZW1BY2NvID0gKGl0ZW0pID0+IHtcbiAgICBjb25zdCBoaWRkZW5Db250ZW50ID0gaXRlbS5maW5kKFwiLnNsaWRlLW1lbnVfX2NvbnRlbnRcIik7XG4gICAgY29uc3QgcmVxV2lkdGggPSBtZXN1cmVXaWR0aChpdGVtKTtcbiAgICBjb25zdCB0ZXh0QmxvY2sgPSBpdGVtLmZpbmQoXCIuc2xpZGUtbWVudV9fY29udGFpbmVyXCIpO1xuXG4gICAgaXRlbS5hZGRDbGFzcyhcImFjdGl2ZS1hY2NvXCIpO1xuICAgIGhpZGRlbkNvbnRlbnQud2lkdGgocmVxV2lkdGguY29udGFpbmVyKTtcbiAgICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XG59XG5cbiQoXCIuc2xpZGUtbWVudV9fdGl0bGVcIikub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5zbGlkZS1tZW51X19pdGVtXCIpO1xuICAgIGNvbnN0IGl0ZW1PcGVuZWRBY2NvID0gaXRlbS5oYXNDbGFzcyhcImFjdGl2ZS1hY2NvXCIpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuc2xpZGUtbWVudVwiKTtcblxuICAgIGlmIChpdGVtT3BlbmVkQWNjbykge1xuICAgICAgICBjbG9zZUV2ZXJ5SXRlbUNvbnQoY29udGFpbmVyKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNsb3NlRXZlcnlJdGVtQ29udChjb250YWluZXIpXG4gICAgICAgIG9wZW5JdGVtQWNjbyhpdGVtKTtcbiAgICB9XG59KTtcblxuJChcIi5zbGlkZS1tZW51X19jbG9zZVwiKS5vbihcImNsaWNrXCIsIGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNsb3NlRXZlcnlJdGVtQ29udCgkKFwiLnNsaWRlLW1lbnVcIikpO1xufSkiLCJjb25zdCBoYW1idXJnZXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhhbWJ1cmdlclwiKTtcbmNvbnN0IG1vZGFsTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZnVsbHNjcmVlbi1tZW51XCIpO1xuY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XG5jb25zdCBoYW1idXJnZXJCdG5DbG9zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xvc2VcIik7XG5cbmhhbWJ1cmdlckJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBtb2RhbE1lbnUuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICBib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcbn0pO1xuXG5oYW1idXJnZXJCdG5DbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBtb2RhbE1lbnUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJcIjtcbn0pO1xuIiwiY29uc3QgdmFsaWRhdGVGaWVsZHMgPSAoZm9ybSwgZmlsZHNBcnJheSkgPT4ge1xuICAgICBcbiAgICBmaWxkc0FycmF5LmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiaW5wdXQtZXJyb3JcIik7XG4gICAgICAgIGlmIChmaWVsZC52YWwoKS50cmltKCkgPT0gXCJcIikge1xuICAgICAgICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTsgXG4gICAgICAgIH1cbiAgICB9KTtcblxuY29uc3QgZXJyb3JGaWVsZHMgPSBmb3JtLmZpbmQoXCIuaW5wdXQtZXJyb3JcIik7XG5cbnJldHVybiBlcnJvckZpZWxkcy5sZW5ndGggPT0gMDtcbn1cblxuJChcIiNmb3JtXCIpLm9uKFwic3VibWl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAvLyBvcGVuTW9kYWwoKTtcblxuICAgIGNvbnN0IGZvcm0gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xuICAgIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XG4gICAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XG4gICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcbiAgICBjb25zdCBtb2RhbCA9ICQoXCIjbW9kYWxcIik7XG4gICAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCIubW9kYWxfX2NvbnRlbnRcIik7XG5cbiAgICBtb2RhbC5yZW1vdmVDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuXG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRmllbGRzKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcbiAgICBcblxuaWYgKGlzVmFsaWQpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcbiAgICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxuICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxuICAgICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxuICAgICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcbiAgICAgICAgICAgIHRvOiB0by52YWwoKSxcbiAgICAgICAgfSxcbiAgICB9KTtcbiAgICByZXF1ZXN0LmRvbmUoZGF0YSA9PntcbiAgICAgICAgICAgIGNvbnRlbnQudGV4dChkYXRhLm1lc3NhZ2UpO1xuICAgIH0pO1xuICAgIHJlcXVlc3QuZmFpbChkYXRhID0+IHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XG4gICAgICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XG4gICAgICAgICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuICAgIH0pO1xuXG4gICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xuICAgICAgICBvcGVuTW9kYWwoKTtcbiAgICB9KVxufVxufSk7XG5cblxuXG5mdW5jdGlvbiBvcGVuTW9kYWwoY29udGVudCkge1xuICAgICQoXCIubW9kYWxcIikuYWRkQ2xhc3MoXCJtb2RhbC0tYWN0aXZlXCIpO1xuICAgICQoXCJib2R5XCIpLmFkZENsYXNzKFwiYmxvY2tlZFwiKTtcbiAgICAvLyAkLmZhbmN5Ym94Lm9wZW4oe1xuICAgIC8vICAgICBzcmM6XCIubW9kYWxcIixcbiAgICAvLyAgICAgdHlwZTpcImlubGluZVwiXG4gICAgLy8gfSlcbn1cblxuJChcIi5qcy1tb2RhbC0tY2xvc2VcIikuY2xpY2soZnVuY3Rpb24oZXZlbnQpe1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgJChcIi5tb2RhbFwiKS5yZW1vdmVDbGFzcyhcIm1vZGFsLS1hY3RpdmVcIik7XG4gICAgJChcImJvZHlcIikucmVtb3ZlQ2xhc3MoXCJibG9ja2VkXCIpO1xuICAgIC8vICQuZmFuY3lib3guY2xvc2UoKTtcbn0pIiwiY29uc3Qgc2VjdGlvbiA9ICQoXCIuc2VjdGlvblwiKTtcbmNvbnN0IGRpc3BsYXkgPSAkKFwiLm1haW5jb250ZW50XCIpO1xuY29uc3Qgc2lkZU1lbnUgPSAkKFwiLmZpeGVkLW1lbnVfX2xpbmtcIik7XG5jb25zdCBmaXhlZE1lbnUgPSAkKFwiLmZpeGVkLW1lbnVcIik7XG5jb25zdCBtZW51SXRlbXMgPSBmaXhlZE1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xuXG5jb25zdCBtb2JpbGVEZXRlY3QgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcbmNvbnN0IGlzTW9iaWxlID0gbW9iaWxlRGV0ZWN0Lm1vYmlsZSgpO1xuXG5sZXQgaW5TY3JvbGwgPSBmYWxzZTtcblxuc2VjdGlvbi5maXJzdCgpLmFkZENsYXNzKFwiYWN0aXZlLXNjcm9sbFwiKTtcblxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSBzZWN0aW9uRXEgPT4ge1xuICAgIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcblxuICAgIGlmIChpc05hTihwb3NpdGlvbikpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcItC/0LXRgNC10LTQsNC90L3QviDQvdC1INCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xuICAgICAgICByZXR1cm4gMDtcblxuICAgIH1cblxuICAgIHJldHVybiBwb3NpdGlvblxufVxuXG5jb25zdCBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uID0gc2VjdGlvbkVxID0+IHtcbiAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb24uZXEoc2VjdGlvbkVxKTtcbiAgICBjb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKTtcbiAgICBjb25zdCBhY3RpdmVDbGFzcyA9IFwiZml4ZWQtbWVudV9ibGFja1wiO1xuXG5cbiAgICBpZiAobWVudVRoZW1lID09IFwiYmxhY2tcIikge1xuICAgICAgICBzaWRlTWVudS5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2lkZU1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xuICAgIH1cbn1cblxuY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcbiAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcbn1cblxuY29uc3QgcGVyZm9tVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XG4gICAgaWYgKGluU2Nyb2xsKSByZXR1cm47XG5cbiAgICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcblxuICAgIGluU2Nyb2xsID0gdHJ1ZTtcblxuICAgIGNvbnN0IHBvc2l0aW9uID0gY291bnRTZWN0aW9uUG9zaXRpb24oc2VjdGlvbkVxKTtcblxuICAgIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcblxuICAgIGRpc3BsYXkuY3NzKHtcbiAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYFxuICAgIH0pO1xuXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbiwgc2VjdGlvbkVxLCBcImFjdGl2ZS1zY3JvbGxcIik7XG5cblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpblNjcm9sbCA9IGZhbHNlO1xuICAgICAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtX2FjdGl2ZVwiKTtcblxuICAgIH0sIHRyYW5zaXRpb25PdmVyICsgbW91c2VJbmVydGlhT3Zlcik7XG59XG5cbmNvbnN0IHZpZXdwb3J0U2Nyb2xsZXIgPSAoKSA9PiB7XG4gICAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb24uZmlsdGVyKFwiLmFjdGl2ZS1zY3JvbGxcIik7XG4gICAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcbiAgICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmV4dCgpIHtcbiAgICAgICAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwZXJmb21UcmFuc2l0aW9uKG5leHRTZWN0aW9uLmluZGV4KCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHByZXYoKSB7XG4gICAgICAgICAgICBpZiAocHJldlNlY3Rpb24ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcGVyZm9tVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH07XG59O1xuXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlID0+IHtcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xuXG4gICAgaWYgKGRlbHRhWSA+IDApIHtcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xuICAgIH1cblxuICAgIGlmIChkZWx0YVkgPCAwKSB7XG4gICAgICAgIHNjcm9sbGVyLnByZXYoKTtcbiAgICB9XG59KTtcblxuJCh3aW5kb3cpLm9uKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgdXNlclR5cGluZ0luSW5wdXQgPSB0YWdOYW1lID09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09IFwidGV4dGFyZWFcIjtcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcblxuICAgIGlmICh1c2VyVHlwaW5nSW5JbnB1dCkgcmV0dXJuO1xuICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICBzY3JvbGxlci5wcmV2KCk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufSk7XG5cbiQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCBlID0+IGUucHJldmVudERlZmF1bHQoKSk7XG5cbiQoXCJbZGF0YS1zY3JvbGwtdG9dXCIpLmNsaWNrKGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAvL21vYWwgY2xvc2UgbW9iaWxlXG4gICAgbW9kYWxNZW51LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJcIjtcblxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcbiAgICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XG5cbiAgICBwZXJmb21UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XG5cbn0pO1xuXG5pZiAoaXNNb2JpbGUpIHtcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW4gXG4gICAgJChcImJvZHlcIikuc3dpcGUoIHtcbiAgICAgICAgc3dpcGU6IGZ1bmN0aW9uIChldmVudCwgZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcbiAgICAgICAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xuXG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwidXBcIikge1xuICAgICAgICAgICAgICAgIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xuICAgICAgICAgICAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwiZG93blwiKSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XG4gICAgICAgICAgICAgICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuXG5cblxuXG4iLCJcblxuY29uc3QgcGxheWVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi52aWRlb19fcGxheWVyXCIpO1xuY29uc3QgcGxheWVyU3RhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcl9fc3RhcnRcIik7XG5jb25zdCBwbGF5ZXJXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3dyYXBwZXJcIik7XG5jb25zdCB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmlkZW9cIik7XG5jb25zdCBwbGF5ZXJQbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3BsYXlcIik7XG5jb25zdCBwbGF5ZXJQbGF5YmFjayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX19wbGF5YmFjay1saW5lXCIpO1xuY29uc3QgcGxheWVyUGxheWJhY2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcl9fcGxheWJhY2stYnV0dG9uXCIpO1xuY29uc3QgcGxheWVyUGxheWJhY2tJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3NvdW5kLWljb25cIik7XG5jb25zdCBwbGF5ZXJQbGF5YmFja0ljb25NdXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3NvdW5kLWljb24tbXV0ZVwiKTtcbmNvbnN0IHNvdW5kTGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX19zb3VuZC1saW5lXCIpO1xuY29uc3Qgc291bmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcl9fc291bmQtYnV0dG9uXCIpO1xubGV0IHN0YXJ0Vm9sdW1lID0gMDtcbmxldCBjdXJyZW50Vm9sdW1lO1xuXG5cbmNvbnN0IGhhZGxlU3RhcnQgPSAoKSA9PiB7XG4gICAgaWYgKHZpZGVvLnBhdXNlZCkge1xuICAgICAgICB2aWRlby5wbGF5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmlkZW8ucGF1c2UoKTtcbiAgICB9XG59XG5cbnBsYXllclBsYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgaGFkbGVTdGFydCgpO1xufSk7XG5wbGF5ZXJTdGFydC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFkbGVTdGFydCk7XG5wbGF5ZXJXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYWRsZVN0YXJ0KTtcblxudmlkZW8ub25wbGF5ID0gKCkgPT4ge1xuICAgIHBsYXllclN0YXJ0LmNsYXNzTGlzdC5hZGQoXCJwYXVzZWRcIik7XG4gICAgcGxheWVyU3RhcnQuY2xhc3NMaXN0LnJlbW92ZShcInBsYXllcl9fc3RhcnRcIik7XG4gICAgcGxheWVyUGxheS5jbGFzc0xpc3QuYWRkKFwicGxheWVyX19wbGF5LW5vbmVcIik7XG59XG52aWRlby5vbnBhdXNlID0gKCkgPT4ge1xuICAgIHBsYXllclN0YXJ0LmNsYXNzTGlzdC5yZW1vdmUoXCJwYXVzZWRcIik7XG4gICAgcGxheWVyU3RhcnQuY2xhc3NMaXN0LmFkZChcInBsYXllcl9fc3RhcnRcIik7XG4gICAgcGxheWVyUGxheS5jbGFzc0xpc3QucmVtb3ZlKFwicGxheWVyX19wbGF5LW5vbmVcIik7XG59XG5cbmNvbnN0IGNoYW5nZVZvbHVtZSA9IChlKSA9PiB7XG4gICAgY29uc3QgY3VycmVudFRhcmdldCA9IGUuY3VycmVudFRhcmdldDtcbiAgICBjb25zdCBsZWZ0ID0gY3VycmVudFRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICAgIGNvbnN0IHNvdW5kTGluZVdpZHRoID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShjdXJyZW50VGFyZ2V0KS53aWR0aCk7XG4gICAgY29uc3QgbmV3UG9zaXRpb24gPSBlLnBhZ2VYIC0gbGVmdDtcbiAgICBjb25zdCBwZXJjZW50VmFsdWUgPSAobmV3UG9zaXRpb24gLyBzb3VuZExpbmVXaWR0aCkgKiAxMDA7XG5cbiAgICB2aWRlby52b2x1bWUgPSBwZXJjZW50VmFsdWUgLyAxMDA7XG4gICAgc291bmRCdG4uc3R5bGUubGVmdCA9IGAke3BlcmNlbnRWYWx1ZX0lYDtcbn1cblxuY29uc3QgdG9vZ2xlU291bmQgPSAoKSA9PiB7XG4gICAgICAgIHBsYXllclBsYXliYWNrSWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwic291bmQtbm9uZVwiKTtcbiAgICAgICAgcGxheWVyUGxheWJhY2tJY29uTXV0ZS5jbGFzc0xpc3QudG9nZ2xlKFwic291bmQtbXV0ZVwiKTtcblxuICAgICAgICBpZiAodmlkZW8udm9sdW1lID09IDApIHtcbiAgICAgICAgICAgIHZpZGVvLnZvbHVtZSA9IGN1cnJlbnRWb2x1bWU7XG4gICAgICAgICAgICBzb3VuZEJ0bi5zdHlsZS5sZWZ0ID0gYCR7Y3VycmVudFZvbHVtZSAqIDEwMH0lYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnRWb2x1bWUgPSB2aWRlby52b2x1bWU7XG4gICAgICAgICAgICB2aWRlby52b2x1bWUgPSBzdGFydFZvbHVtZTtcbiAgICAgICAgICAgIHNvdW5kQnRuLnN0eWxlLmxlZnQgPSBgJHtzdGFydFZvbHVtZX0lYDtcbiAgICB9XG59XG5cblxuc291bmRMaW5lLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjaGFuZ2VWb2x1bWUpO1xucGxheWVyUGxheWJhY2tJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0b29nbGVTb3VuZCk7XG5wbGF5ZXJQbGF5YmFja0ljb25NdXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0b29nbGVTb3VuZCk7XG5cbmNvbnN0IGhhbmRsZUR1cmF0aW9uID0gKGUpID0+IHtcbiAgICBjb25zdCBiYXJTaXplID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShwbGF5ZXJQbGF5YmFjaykud2lkdGgpO1xuICAgIGNvbnN0IGNpcmNsZVdpZHRoID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShwbGF5ZXJQbGF5YmFja0J0bikud2lkdGgpO1xuICAgIGNvbnN0IG9mZnNldFggPSBlLm9mZnNldFg7XG4gICAgY29uc3QgbmV3U2l6ZSA9IG9mZnNldFggKyBjaXJjbGVXaWR0aCAvIDI7XG4gICAgY29uc3QgbmV3VGltZSA9IChuZXdTaXplICogdmlkZW8uZHVyYXRpb24pIC8gYmFyU2l6ZTtcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IG5ld1RpbWU7XG59XG5cbmNvbnN0IHVwZGF0ZVRpbWUgPSAoKSA9PiB7XG4gICAgbGV0IGJhciA9IHZpZGVvLmN1cnJlbnRUaW1lIC8gdmlkZW8uZHVyYXRpb247XG4gICAgcGxheWVyUGxheWJhY2tCdG4uc3R5bGUubGVmdCA9IGAke2JhciAqIDEwMH0lYDtcblxuICAgIGlmICh2aWRlby5lbmRlZCkge1xuICAgICAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XG4gICAgfVxufVxuXG5wbGF5ZXJQbGF5YmFjay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRHVyYXRpb24pO1xudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcInRpbWV1cGRhdGVcIiwgdXBkYXRlVGltZSk7XG4vL3lvdVR1YmUgQVBJXG5cbi8vIGxldCBwbGF5ZXI7XG5cbi8vIGNvbnN0IHBsYXllckNvbnRhaW5lciA9ICQoXCIucGxheWVyX19zdGFydFwiKTtcbi8vIGNvbnN0IHZpZGVvID0gJChcIi52aWRlb1wiKTtcblxuLy8gbGV0IGV2ZW50c0luaXRJbiA9ICgpID0+IHtcbi8vICAgICAkKFwiLnBsYXllcl9fc3RhcnRcIikuY2xpY2soZSA9PiB7XG4vLyAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgXG4vLyAgICAgICAgIGlmIChwbGF5ZXJDb250YWluZXIuaGFzQ2xhc3MoXCJwYXVzZWRcIikpIHtcbi8vICAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInBhdXNlZFwiKTtcbi8vICAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllcl9fc3RhcnRcIilcbi8vICAgICAgICAgICAgIHBsYXllclBsYXkucmVtb3ZlQ2xhc3MoXCJwbGF5ZXJfX3BsYXktbm9uZVwiKVxuLy8gICAgICAgICAgICAgdmlkZW8ucGxheSgpO1xuLy8gICAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICAgICAgcGxheWVyQ29udGFpbmVyLmFkZENsYXNzKFwicGF1c2VkXCIpO1xuLy8gICAgICAgICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwicGxheWVyX19zdGFydFwiKVxuLy8gICAgICAgICAgICAgcGxheWVyUGxheS5hZGRDbGFzcyhcInBsYXllcl9fcGxheS1ub25lXCIpXG4vLyAgICAgICAgICAgICB2aWRlby5wbGF5KCk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgIH0pO1xuLy8gICAgICB9O1xuXG4vLyAgICAgY29uc3QgcGxheWVyUGxheSA9ICQoXCIucGxheWVyX19wbGF5XCIpIFxuXG4vLyAgICAgIGxldCBldmVudHNJbml0UGxheSA9ICgpID0+IHtcbi8vICAgICAgICAgICQoXCIucGxheWVyX19wbGF5XCIpLmNsaWNrKGUgPT4ge1xuLy8gICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4vLyAgICAgICAgICAgICBpZiAocGxheWVyUGxheS5oYXNDbGFzcyhcInBsYXllcl9fcGxheS1ub25lXCIpKSB7XG4vLyAgICAgICAgICAgICAgICAgcGxheWVyUGxheS5yZW1vdmVDbGFzcyhcInBsYXllcl9fcGxheS1ub25lXCIpO1xuLy8gICAgICAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllcl9fc3RhcnRcIilcbi8vICAgICAgICAgICAgICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwYXVzZWRcIik7XG4vLyAgICAgICAgICAgICAgICAgcGxheWVyLnBhdXNlVmlkZW8oKTtcbi8vICAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAgICAgcGxheWVyQ29udGFpbmVyLmFkZENsYXNzKFwicGF1c2VkXCIpO1xuLy8gICAgICAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInBsYXllcl9fc3RhcnRcIilcbi8vICAgICAgICAgICAgICAgICBwbGF5ZXJQbGF5LmFkZENsYXNzKFwicGxheWVyX19wbGF5LW5vbmVcIik7XG4vLyAgICAgICAgICAgICAgICAgcGxheWVyLnBsYXlWaWRlbygpO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgfSk7XG4vLyAgICAgIH1cblxuLy8gICAgIC8vICBsZXQgcGxheUJhY2tMaW5lID0gKCkgPT4ge1xuLy8gICAgICAgICAgY29uc29sZS5sb2coXCJpbnNpZGVwbGF5QmFja0xpbmVcIik7XG4vLyAgICAgICAgICAkKFwiLnBsYXllcl9fcGxheWJhY2stbGluZVwiKS5jbGljayhlID0+IHtcbiAgICAgICAgICAgICBcbi8vICAgICAgICAgICAgICBjb25zdCBiYXIgPSAkKGUuY3VycmVudFRhcmdldCk7XG4vLyAgICAgICAgICAgICAgY29uc3QgY2xja2VkUG9zaXRpb24gPSBlLm9yaWdpbmFsRXZlbnQubGF5ZXJYO1xuLy8gICAgICAgICAgICAgIGNvbnN0IGJ1dHRvblBvc2l0aW9uID0gKGNsY2tlZFBvc2l0aW9uIC8gYmFyLndpZHRoKCkpICogMTAwOyBcbi8vICAgICAgICAgICAgICBjb25zdCB2aWRlb1Bvc2l0aW9uID0gKHBsYXllci5nZXREdXJhdGlvbigpIC8gMTAwKSAqIGJ1dHRvblBvc2l0aW9uO1xuICAgICAgICAgICAgIFxuLy8gICAgICAgICAgICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcbi8vICAgICAgICAgICAgICAgICAgbGVmdDogYCR7YnV0dG9uUG9zaXRpb259JWBcbi8vICAgICAgICAgICAgICB9KVxuLy8gICAgICAgICAgICAgcGxheWVyLnNlZWtUbyh2aWRlb1Bvc2l0aW9uKTtcbi8vICAgICAgICAgICAgIH0pXG4vLyAgICAgLy8gIH07XG5cbi8vICAgICAgY29uc3Qgb25QbGF5ZXJSZWFkeSA9ICgpID0+IHtcbi8vICAgICAgICAgIGxldCBpbnRlcnZhbDtcbi8vICAgICAgICAgIGNvbnN0IGR1cmF0aW9uU2VjID0gcGxheWVyLmdldER1cmF0aW9uKCk7XG5cbi8vICAgICAgICAgIGlmICh0eXBlb2YgaW50ZXJ2YWwgIT09IFwidW5kZWZpbmVkXCIpIHtcbi8vICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbi8vICAgICAgICAgIH1cblxuLy8gICAgICAgICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4vLyAgICAgICAgICAgICBjb25zdCBjb21wbGV0ZWRTZWMgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKTsgXG4vLyAgICAgICAgICAgICBjb25zdCBjb21wbGV0ZWRQZXJjZW50ID0gKGNvbXBsZXRlZFNlYyAvIGR1cmF0aW9uU2VjKSAqIDEwMDtcblxuLy8gICAgICAgICAgICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xuLy8gICAgICAgICAgICAgICAgIGxlZnQ6IGAke2NvbXBsZXRlZFBlcmNlbnR9JWBcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICAgfSwgMTAwMCk7XG4vLyAgICAgIH07IFxuXG4vLyBmdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcbi8vICAgcGxheWVyID0gbmV3IFlULlBsYXllcihcInl0LXBsYXllclwiLCB7XG4vLyAgICAgaGVpZ2h0OiAnMzYwJyxcbi8vICAgICB3aWR0aDogJzY2MCcsXG4vLyAgICAgdmlkZW9JZDogJ2tfZ19OTTJZeFpBJyxcbi8vICAgICBldmVudHM6IHtcbi8vICAgICAgICAgJ29uUmVhZHknOiBvblBsYXllclJlYWR5LFxuLy8gICAgICAgICAvLyAnb25TdGF0ZUNoYW5nZSc6IG9uUGxheWVyU3RhdGVDaGFuZ2Vcbi8vICAgICAgIH0sXG4vLyAgICAgICBwbGF5ZXJWYXJzOiB7XG4vLyAgICAgICAgIGNvbnRyb2xzOiAwLFxuLy8gICAgICAgICBkaXNhYmxla2I6IDAsXG4vLyAgICAgICAgIHNob3dpbmZvOiAwLFxuLy8gICAgICAgICByZWw6IDAsXG4vLyAgICAgICAgIGF1dG9wbGF5OiAwLFxuLy8gICAgICAgICBtb2Rlc3RicmFuZGluZzogMFxuLy8gICAgICAgfVxuLy8gICAgIH0pO1xuLy8gfVxuXG4vLyBldmVudHNJbml0SW4oKTtcblxuLy8gZXZlbnRzSW5pdFBsYXkoKTtcblxuLy8gLy8gcGxheUJhY2tMaW5lKCk7XG5cbiIsImNvbnN0IHNsaWRlciA9ICQoJy5zaG9wJykuYnhTbGlkZXIoe1xuICBwYWdlcjogZmFsc2UsIFxuICBjb250cm9sczogZmFsc2UsXG4gIHRvdWNoRW5hYmxlZDogJCh3aW5kb3cpLndpZHRoKCkgPCA3Njhcbn0pO1xuXG4kKFwiLmFycm93X19sZWZ0XCIpLmNsaWNrKGUgPT4ge1xuICBzbGlkZXIuZ29Ub1ByZXZTbGlkZSgpO1xufSk7XG5cbiQoXCIuYXJyb3dfX3JpZ2h0XCIpLmNsaWNrKGUgPT4ge1xuICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xufSk7IiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IGFsaWFzID0+IHtcbiAgICByZXR1cm4gJChcIi5yZXZpZXdzX19pdGVtXCIpLmZpbHRlcigobmR4LCBpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09IGFsaWFzXG4gICAgfSk7XG59O1xuJChcIi5yZXZpZXdzX19zd2l0Y2hlci1saW5rXCIpLmNsaWNrKChlKSA9PiB7IFxuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLW9wZW5cIik7XG4gICAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcbiAgICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJcIik7XG5cblxuICAgIGl0ZW1Ub1Nob3cuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICBjdXJJdGVtLmFkZENsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyX2FjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyX2FjdGl2ZVwiKTtcbn0pOyJdfQ==
